---
title: Cherry Studio çŸ¥è¯†åº“V2 ææ¡ˆ
date: 2025-12-21
lang: zh
duration: 10min
type: blog
image: https://chentao0717.cn/og/cherry-knowledge-v2.jpg
---

## ç›®æ ‡

åœ¨Agentæ—¶ä»£ï¼Œæ‰“é€ ä¸€ä¸ªä¸ºAgentä½¿ç”¨çš„æ™ºèƒ½çŸ¥è¯†åº“ã€‚å®ƒä¸åº”è¯¥åªæ˜¯ä¸€ä¸ªæä¾›æŸ¥è¯¢çš„"å›¾ä¹¦é¦†"ï¼Œè€Œåº”è¯¥æ˜¯èƒ½ç”±Agentè¿›è¡Œ **è‡ªåŠ©é˜…è¯»ã€è‡ªæˆ‘å­¦ä¹ ã€è‡ªæˆ‘ä¼˜åŒ–** çš„åŠ¨æ€æ•°æ®åº“ã€‚

## 3ç§å¸¸è§çš„RAGæ¶æ„å¯¹æ¯”

| Modular RAG(å½“å‰æ¶æ„)                                  | Graph RAG                                              | Agentic RAG(ç›®æ ‡æ¶æ„)                             |
| ------------------------------------------------------ | ------------------------------------------------------ | ------------------------------------------------- |
| åœ¨ä¼ ç»ŸRAGçš„åŸºç¡€ä¸Šæ·»åŠ äº†é‡æ’åº+é‡å†™ç­‰æ¨¡å—               | ä½¿ç”¨çŸ¥è¯†å›¾è°±ï¼Œç”¨å…³ç³»å¢åŠ æ£€ç´¢                           | ä»¥"åŸå­åŒ–"çš„æ–¹å¼ç»„ç»‡ï¼Œå°†ç»„ç»‡äº¤ç»™Agent             |
| âŒåªèƒ½é€šè¿‡å›ºå®šæµç¨‹(é‡å†™+æŸ¥è¯¢+é‡æ’åº)ï¼Œç³»ç»Ÿæ— æ³•çµæ´»è°ƒæ•´ | âŒæ„å»ºæˆæœ¬é«˜(æŠ½å–å…³ç³»)ï¼Œçµæ´»æ€§å·®(ä¸€æ—¦æ„å»ºï¼Œå…³ç³»ä¸å¯å˜) | âœ…Agentå¯ä»¥è‡ªç”±è°ƒæ•´æµç¨‹ï¼Œç»„ç»‡çŸ¥è¯†åº“ï¼Œå®ç°åŠ¨æ€ä¼˜åŒ– |

## åŸå­åŒ–RAGæ¶æ„

åŸå­åŒ–RAGåªæä¾›æœ€ç®€èƒ½åŠ›ï¼Œä»¥MCPçš„å½¢å¼æä¾›ç»™Agentä½¿ç”¨ï¼Œå¹¶ä¸”æš´éœ²APIå¯ä»¥æä¾›ç»™å¤–éƒ¨ä½¿ç”¨ã€‚

æä¾›ä¸¤ç§æ“ä½œæ¨¡å¼:

1. ğŸ›¡ï¸æ ‡å‡†æ¨¡å¼(å®‰å…¨é©¾é©¶):æä¾›æœ€ç®€å•çš„"å¢ã€åˆ ã€æ”¹ã€æŸ¥"èƒ½åŠ›ï¼ŒAgentå¯ä»¥æ”¾å¿ƒåœ°å†™å…¥çŸ¥è¯†ï¼Œç³»ç»Ÿåœ¨åå°ä¼šè‡ªåŠ¨å¤„ç†æ‰€æœ‰å¤æ‚çš„æŠ€æœ¯ç»†èŠ‚ï¼ˆå¦‚å‘é‡åŒ–ï¼‰ã€‚
2. âš¡ï¸ä¸Šå¸æ¨¡å¼(èµ›é“ç‹‚é£™):ç›´æ¥å¼€æ”¾ SQL æŸ¥è¯¢æ¥å£ã€‚ç”¨æˆ·/Agentå¯ä»¥è‡ªç”±çš„å¯¹çŸ¥è¯†åº“è¿›è¡Œæ“ä½œï¼Œä¾‹å¦‚ "å¯ä»¥æŸ¥è¯¢çŸ¥è¯†åº“ä¸­çš„æ–‡æ¡£ä¸ªæ•°"ï¼Œ"çŸ¥è¯†åº“ä¸­æœ‰ä»€ä¹ˆå†…å®¹"ç­‰ã€‚
3. APIæ¨¡å¼:æä¾›APIæ¥å£ï¼Œå…è®¸å¤–éƒ¨ç³»ç»Ÿç›´æ¥æ“ä½œçŸ¥è¯†åº“ï¼Œæ–¹ä¾¿æ„å»ºæµ‹è¯•é›†ã€åœ¨å·²æœ‰å·¥ä½œæµä¸­è°ƒç”¨æˆ–è€…å®ç°å¯¹çŸ¥è¯†åº“è¿›è¡Œå¼ºåŒ–å­¦ä¹ è®­ç»ƒ[^1]ã€‚

## Agentèƒ½åˆ©ç”¨åŸå­åŒ–RAGåšåˆ°ä»€ä¹ˆï¼Ÿ

1. åŸºç¡€RAGèƒ½åŠ›

- æ–‡æ¡£é¢„å¤„ç†
- æ··åˆæ£€ç´¢(BM25+å‘é‡æ£€ç´¢) + é‡æ’åº
- ç­›é€‰æ£€ç´¢(æ ¹æ®æ¥æºã€æ—¶é—´ã€æ ‡ç­¾ç­‰æ¡ä»¶è¿›è¡Œè¿‡æ»¤)

2. çŸ¥è¯†ç»´æŠ¤

- Agentåœ¨å¯¹è¯ä¸­å¯ä»¥ç›´æ¥å¯¹çŸ¥è¯†åº“è¿›è¡ŒåµŒå…¥
- Agentåœ¨å¯¹è¯ä¸­å‘ç°æ–‡æ¡£ä¸­å­˜åœ¨é”™è¯¯æˆ–è¿‡æ—¶ä¿¡æ¯æ—¶å¯ä»¥ç›´æ¥ä¿®æ”¹çŸ¥è¯†åº“

3. æ™ºèƒ½æ ‡æ³¨[^2]

- Agentå¯ä»¥å¯¹chunkå—çš„metadataè¿›è¡Œæ ‡æ³¨ï¼Œä¾‹å¦‚æ·»åŠ æ ‡ç­¾ã€æ¥æºã€æ—¶é—´ç­‰ä¿¡æ¯
- Agentä¹Ÿå¯ä»¥ç»™é«˜è´¨é‡çš„chunkæ‰“åˆ†ï¼Œæ£€ç´¢æ—¶å¯ä»¥æé«˜æ£€ç´¢æƒé‡

## åŸå­åŒ–RAGçš„ç™¾å˜èƒ½åŠ›

1. åŸå­åŒ–RAG -> Modular RAG
   å½“ä½ æŠŠ `search` æ¥å£å†…éƒ¨é›†æˆäº† Hybrid Search å’Œ Rerankï¼Œå¹¶ä¸” Agent åœ¨è°ƒç”¨å‰è‡ªå·±åšäº†ä¸€æ­¥ Query Rewriteï¼ˆæŸ¥è¯¢é‡å†™ï¼‰æ—¶ï¼š

- åŠ¨ä½œæµï¼šAgent (Rewrite) -> MCP Tool (Hybrid Search + Rerank) -> Agent (Synthesis)ã€‚
- æœ¬è´¨ï¼šè¿™å°±æ˜¯æ ‡å‡†çš„ Modular RAG æµç¨‹ã€‚
- åŒºåˆ«ï¼šä¼ ç»Ÿ Modular RAG åœ¨ä»£ç **å†™æ­»**æŠŠè¿™äº›æ¨¡å—ä¸²èµ·æ¥ï¼›è€Œä½ çš„æ¶æ„é‡Œï¼ŒAgent æ ¹æ®éœ€è¦è‡ªå·±å†³å®šè¦ä¸è¦ rewriteï¼Œè¦ä¸è¦ rerankã€‚

2. åŸå­åŒ–RAG -> Graph RAG
   å½“ä½ åœ¨ metadata ä¸­å­˜å‚¨äº†å…³è”ä¿¡æ¯ï¼ˆå¦‚ {"links": ["doc_id_123"]}ï¼‰ï¼Œå¹¶ä¸” Agent æ‡‚å¾—é¡ºè—¤æ‘¸ç“œæ—¶ï¼š

- åŠ¨ä½œæµï¼šAgent æœåˆ°æ–‡æ¡£ A -> å‘ç° Metadata é‡Œæœ‰å…³è”æ–‡æ¡£ B -> Agent ä¸»åŠ¨è°ƒç”¨ read_document(B) -> ç»¼åˆ A å’Œ B å›ç­”ã€‚
- æœ¬è´¨ï¼šè¿™å°±æ˜¯å›¾è°±æ£€ç´¢ä¸­çš„â€œé‚»å±…èŠ‚ç‚¹éå†â€ã€‚
- åŒºåˆ«ï¼š
  - ç¡¬å›¾è°± (Hard Graph)ï¼šNeo4j ç­‰æ•°æ®åº“ï¼Œå…³ç³»æ˜¯ç‰©ç†å­˜åœ¨çš„ï¼ŒæŸ¥è¯¢å¿«ä½†æ„å»ºæè´µã€‚
  - è½¯å›¾è°± (Soft Graph)ï¼šå…³ç³»å­˜åœ¨ Metadata é‡Œï¼Œç”± Agent çš„æ³¨æ„åŠ›ï¼ˆAttentionï¼‰æ¥"è„‘è¡¥"è¿æ¥ã€‚è™½ç„¶é€Ÿåº¦æ…¢ä¸€ç‚¹ï¼Œä½†æ„å»ºæˆæœ¬å‡ ä¹ä¸ºé›¶ï¼Œä¸”æå…¶çµæ´»ã€‚

ä½ çš„ Agent ä¼šæ ¹æ®ç”¨æˆ·çš„é—®é¢˜ï¼ŒåŠ¨æ€åç¼©æˆæœ€é€‚åˆçš„æ¶æ„ï¼š

- ç”¨æˆ·é—®æ¨¡ç³Šæ¦‚å¿µï¼ˆå¦‚â€œé‚£ä¸ª...ä»€ä¹ˆè®¡åˆ’â€ï¼‰ğŸ‘‰ Agent èµ° Modular RAG æ¨¡å¼ï¼Œå…ˆé‡å†™æŸ¥è¯¢ï¼Œå†æ··åˆæ£€ç´¢ã€‚
- ç”¨æˆ·é—®æ·±åº¦å…³è”ï¼ˆå¦‚â€œAé¡¹ç›®å¯¹Bå…¬å¸çš„è´¢åŠ¡å½±å“â€ï¼‰ğŸ‘‰ Agent èµ° Graph RAG æ¨¡å¼ï¼Œæœåˆ°Aï¼Œè¯» Metadata é‡Œçš„é“¾æ¥æ‰¾åˆ°Bï¼Œå†ç»¼åˆæ¨ç†ã€‚

## ä½¿ç”¨ç¤ºä¾‹

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ çš„ AI åŠ©æ‰‹æ­£åœ¨ä½¿ç”¨ Agentic RAG MCP:

1. ç”¨æˆ·æé—®:"é¡¹ç›®Açš„è¿›åº¦æ€ä¹ˆæ ·äº†ï¼Ÿ"
2. æ£€ç´¢:AI æœç´¢çŸ¥è¯†åº“ï¼Œå‘ç°äº†ä¸¤ä»½æ–‡æ¡£ã€‚ä¸€ä»½æ˜¯"é¡¹ç›®Aå¯åŠ¨ä¼š"ï¼Œå¦ä¸€ä»½æ˜¯"é¡¹ç›®Aæš‚åœé€šçŸ¥"ã€‚
3. æ¨ç†ä¸ä¿®æ­£:AI å‘ç°"å¯åŠ¨ä¼š"çš„å†…å®¹å·²ç»è¿‡æ—¶äº†ã€‚å®ƒæ²¡æœ‰ç›´æ¥æŠŠæ—§ä¿¡æ¯ç»™ä½ ï¼Œè€Œæ˜¯:

- å…ˆå›ç­”ä½ :"é¡¹ç›®Aç›®å‰å·²æš‚åœã€‚"
- åœ¨åå°:ç»™"å¯åŠ¨ä¼š"æ–‡æ¡£æ‰“ä¸Š [å·²è¿‡æ—¶] çš„æ ‡ç­¾ï¼Œå¹¶é™ä½äº†å®ƒçš„æƒé‡ã€‚

4. è®°å¿†æ²‰æ·€:ä½ åœ¨å¯¹è¯ä¸­å‘Šè¯‰ AI:"ä»¥åé¡¹ç›®Aæ”¹åå«å‡¤å‡°è®¡åˆ’ã€‚"

- åœ¨åå°:AI è‡ªåŠ¨åœ¨çŸ¥è¯†åº“é‡Œç»™ç›¸å…³æ–‡æ¡£æ·»åŠ äº†"å‡¤å‡°è®¡åˆ’"çš„åˆ«åæ ‡ç­¾ã€‚
  ä¸‹ä¸€æ¬¡ï¼Œå½“ä½ æœ"å‡¤å‡°è®¡åˆ’"æ—¶ï¼ŒAI å°±èƒ½ç«‹åˆ»æ‰¾åˆ°æ‰€æœ‰èµ„æ–™ã€‚è¿™å°±æ˜¯"å¯è¿›åŒ–çš„ç¬¬äºŒå¤§è„‘"ã€‚

> è¿™æ˜¯ä¸€ç±»æ›´ç±»ä¼¼RL-likeçš„æ¶æ„ï¼Œå®ƒå…è®¸Agentåœ¨å¯¹è¯ä¸­ä¸æ–­ä¼˜åŒ–è‡ªå·±çš„çŸ¥è¯†åº“ï¼Œå®ç°åŠ¨æ€å­¦ä¹ å’Œä¼˜åŒ–ã€‚

## å‚è€ƒæ–‡çŒ®

[^1]: [R3-RAG: Learning Step-by-Step Reasoning and Retrieval for LLMs via Reinforcement Learning](https://arxiv.org/abs/2505.23794)
[^2]: [Thinking Forward and Backward:Multi-Objective Reinforcement Learning for Retrieval-Augmented Reasoning](https://arxiv.org/pdf/2511.09109)
